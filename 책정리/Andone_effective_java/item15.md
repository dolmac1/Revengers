# item 15 클래스와 멤버의 접근 권한을 최소화하라

## 잘 설계된 컴포넌트란?

어설프게 설계된 컴포넌트와 잘 설계된 컴포넌트의 차이점은 클래스 내부 데이터와 내부 구현 정보를 외부 컴포넌트로부터 얼마나 잘 숨겼느냐다.

밖으로 드러난 인터페이스를 통해서만 통신하고 내부구현을 숨긴다. 이를 정보 은닉, 캡슐화라고 하며 소프트웨어 설계의 근간이다.

정보은닉의 장점은 다음과 같다.

- 시스템 개발 속도를 높인다. 여러 컴포넌트를 병렬로 개발할 수 있기 때문이다.
- 시스템 관리 비용을 낮춘다. 각 컴포넌트를 더 빠르게 파악하여 디버깅을 할 수 있고 다른 컴포넌트로 교체하는 것도 비교적 비용이 적다.
  (인터페이스가 같다면 인터페이스 윗단은 바꿀 필요가 없기 때문)
- 정보 은닉 자체가 성능을 높여주지는 않으나, 성능 최적화에 도움을 준다. 완성된 시스템을 프로파일링해 최적화가 필요한 컴포넌트를 선택 후 해당 컴포넌트만 최적화 시킬 수 있기 때문이다.
- 소프트웨어 재사용성을 높인다. 외부에 거의 의존하지 않고 독자적으로 사용될 수 있는 컴포넌트라면 해당 컴포넌트를 이전에 사용하지 않은 낯선 환경에서도 잘 동작할 가능성이 높다.
- 컴포넌트 별로 나눠서 개발하면 되기 때문에 큰 시스템의 개발 난이도를 줄어준다.

자바는 컴포넌트의 정보 은닉을 위한 여러가지 도구구를 제공하는데 기본 원칙은 *__"모든 클래스와 멤버의 접근성을 가능한 한 좁여야 한다."__* 이다. 즉, 소프트웨어가 동작하는데 영향이 없는한 최대한 권한을 작게 유지시켜야 한다.

 가장 바깥 클래스와 인터페이스에게 부여할 수 있는 접근 수준은 pakage-private와 public인데 public은 외부에서 사용이 가능하고 pakage-private는 외부에서 사용이 불가능 하기 때문에 외부에서 접근할 필요가 없는 클래스에 대해서는 pakage-private로 선언하는것이 좋다. public은 공개 API가 된다. pakage-private는 외부에 공개된 API가 아니기 떄문에 언제든지 내부를 바꿔줄 수 있다. public일 경우는 외부와의 호환성 떄문에 지속적인 관리가 필요하다.

 한 클래스에서만 사용하는 package-private 톱레벨 클래스나 인터페이스는 이를 사용하는 클래스 안에 private static으로 중첩시켜보자. 탑 레벨 클래수로 두면 같은 패키지에 모든 클래스가 접근 할 수 있지만 바깥에서는 접근할 수 없다. 이때, 가장 중요한 것은 public으로 공개되는 클래스를 줄이는 것이다.

접근 제어자는 우리가 아는 private, package-private, protected, public이다.

공개가 되어야 하는 API는 잘 선택하고 나머지는 멤버는 private으로 그리고 다른 패키지내의 다른 곳에서 사용해야 하는 멤버들인 packge-private로 바꿔준다. 단, Serializable을 구현한 클래스는 원하지 않는데도 공개 API가 되는 경우다 있다. 그리고 public class의 protected는 접근 대상이 매우 늘어나기 때문에 영원히 지원되어야 하며, 내부 동작 방식을 API 문서에 기술 해 줘야할 수도 있다.

단지 코드를 테스트 하기 위한 목적으로 클래스, 인터페이스, 멤버의 접근 범위를 넓힐 수 있지만 테스트만을 위해서는 공개 API를 만들어서는 안된다.

*__public 클래스의 인스턴스 필드는 되도록 public이 아니어야 한다.__* 필드가 가변 객체를 참조하거나, final이 아닌 인스턴스 필드를 public으로 선언하면 그 필드에 담을 수 있는 값을 제한할 힘을 잃게 된다. 그 필드와 관련된 불변식을 보장할 수 없게 된다는 말이다. 그리고 필드가 수정될 때 스레드 락과 같은 작업을 할 수 없기 때문에 *__"public 가변 필드를 갖는 클래스는 일반적으로 스레드 안전하지 않다."__* 필드가 final이면서 불변 객체를 참조하더라도 여전히 문제가 남는다. 내부 구현을 바꾸고 싶어도 public 필드를 없애는 방식으로는 리팩터링을 할 수 없다.(이미 외부에 공개된 것과 호환성을 맞춰야 하기 때문)

이러한 문제는 정적 필드에서도 마찬가지이지만, 꼭 필요한 상수의 경우는 public static final 필드로 공개해도 되며 네이밍 규칙은 대문자 알파벳으로 쓰며 단어 사이의 공간에 _로 표현한다. 또한, 클래스에서 public static final 배열 필드로 두거나 이 필드를 반환하는 접근자 메서드를 제공해서는 안된다. (배열의 내부 요소는 수정이 가능하기 때문이다.)

만약, 공개가 필요하다면 배열은 private으로 선언해놓고 불변 리스트를 공개로 돌려놓는다.

### 모르겠는데..?

자바 9부터 공개된 모듈 시스템이 뭔지 이해가 되지 않음..